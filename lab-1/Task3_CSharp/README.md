# Пакетные менеджеры

## Задание

> Написать алгоритм обхода графа (DFS и BFS) на языке Java, собрать в пакет и опубликовать (хоть в Maven, хоть в Gradle, не имеет значения).
> Использовать в другом проекте на Java/Scala этот пакет. Повторить это с C#/F#. В отчёте написать про алгоритм работы пакетных менеджеров, особенности их работы в C# и Java мирах.

## Теормин

## Пакетный менеджер

**Пакетный менеджер** - набор программного обеспечения, позволяющего управлять процессом установки, удаления, настройки и обновления различных компонентов программного обеспечения.

## Пакет

**Пакет** - сущность, включающая в себя скомпилированный код (в виде библиотек DLL или JAR) и другое содержимое, необходимое использующим эти пакеты проектам _(POM файлы)_.

## Решение

Пишем код DFS и BFS на языках `Java` и `C#`, упаковываем проекты в пакеты `Maven` и `NuGet`, после чего подклюсаем их и используем в языках `Scala` и `F#` соответственно.

## Java/Scala

Java — язык, в котором вы не можете просто добавить свои собственные пакеты в основной репозиторий.
Утвержденные службы размещения репозиториев, такие как `Nexus`, должны проверить и согласиться разместить ваш пакет на своей платформе.

Основными пакетными менеджерами для `Java` являются `Maven` и `Gradle`.

### Maven

`Maven` является отраслевым стандартом.
Центральный репозиторий Maven — это онлайн-репозиторий, содержащий широкий спектр пакетов, доступных для использования в ваших проектах.

- Имеет файл `pom.xml` _(project object model)_ для хранения конфигураций и зависимостей проекта _(чем-то похож на package.json из JS)_;
- Позволяет использовать готовые шаблоны проектов со стандартной структурой папок, создавая их самостоятельно.
- Имеет множество шаблонный агентов запуска, тестирования, загрузки/очистки зависимостей и т.д. из коробки.

### Gradle

`Gradle` - это относительно новое решение для управления пакетами, которое быстро выросло за последние годы из-за менее подробного синтаксиса и более быстрого времени сборки.

В качестве пакетного менеджера был выбран именно `Maven`.

### Создание и подключение пакета в Maven

Для создания собственного пакета в Maven я сделал следующие действия:

1. Подключил поддержку `Maven` в нужный модуль (ПКМ на модуль -> `Add Framework Support` -> `Maven`);
2. После чего заполнил нужные поля в `pom.xml` файле (`groupId`, `artifactId`, `version`).

```markdown
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>lipa</groupId>
    <artifactId>Task3_Java</artifactId>
    <version>1.0</version>
    <dependencies>
        <dependency>
            <groupId>org.openjdk.jmh</groupId>
            <artifactId>jmh-core</artifactId>
            <version>1.23</version>
        </dependency>
    </dependencies>

    <properties>
        <maven.compiler.source>17</maven.compiler.source>
        <maven.compiler.target>17</maven.compiler.target>
    </properties>
    
</project>
```

3. Нажал запуск агента `package`, который предоставлен благодаря подключению поддержки `Maven`.
Данный агент создал `.class` файлы для всех описанных классов, а также `.jar` файл, с помощью которого мы будем подключать наш пакет в `Scala`;

4. Для подключения нашего пакета `Java` из `Scala` я создал новый модуль, и класс `.scala` в нём.
Далее нужно подключить созданный на предыдущем шаге пакет, для этого ПКМ на модуль -> `Open Modole Settings` -> `Libraries` -> `New Project Library` -> `Java` -> выбираем `.jar` файл, который был создан на предыдущем шаге.

5. После выполнения п.4 нам у нас должна была создаться зависимость между модулями, что выражается в соответствующих записях в `pom.xml` файле `Scala`.

```markdown
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>lipa</groupId>
    <artifactId>Task3_Scala</artifactId>
    <version>1.0</version>

    <dependencies>
        <dependency>
            <groupId>lipa</groupId>
            <artifactId>Task3_Java</artifactId>
            <version>1.0</version>
        </dependency>
    </dependencies>

    <properties>
        <maven.compiler.source>17</maven.compiler.source>
        <maven.compiler.target>17</maven.compiler.target>
    </properties>

</project>
```

## C#/F#

Единственным и основным пакетным менеджером в `.NET` является `NuGet`, который определяет, как создаются, размещаются и используются пакеты для `.NET`, а также предоставляет средства для каждой из этих ролей.

`NuGet` представляет собой отдельный ZIP-файл с расширением .nupkg, который содержит скомпилированный код (DLL), другие файлы, связанные с этим кодом, и описательный манифест, включающий такие сведения, как номер версии пакета.

### Основные задачи и функции `NuGet`

- **Управление зависимостями** - вам нужно заботиться только о тех пакетах, которые вы используете непосредственно в проекте. Если эти пакеты используют другие пакеты, все эти зависимости нижнего уровня обрабатывает NuGet;

- **Отслеживание ссылок и восстановление пакетов** - `NuGet` поддерживает простой список ссылок на пакеты _(**PackageReference**)_, от которых зависит проект, включая зависимости верхнего и нижнего уровня. То есть при установке пакета с некоторого узла в проект `NuGet` записывает идентификатор пакета и номер версии в этот список ссылок, а не его байтовую копию _(dll или аналогичный файл)_;

- **Кеширование и шаринг пакетов** - `NuGet` управляет кэшем пакета и папкой глобальных пакетов.
Кэш позволяет избежать загрузки пакета, который уже установлен на компьютере. Папка глобальных пакетов позволяет в нескольких проектах совместно использовать один установленный пакет.

### Создание и подключение пакета в NuGet

1. Для того, чтобы создать и опубликовать пакет в NuGet, необходимо зарегистрироваться на сайте `nuget.org`, который является репозиторием для всех пакетов `NuGet`;

2. После регистрации мы создаём проект типа Library пишем нужный нам код, далее: ПКМ на проект -> `Properties` -> `NuGet` и указываем все нужные данные о нашем пакете, такие как имя, версия, автор и т.д;

3. После указания конфигурации нашего пакета необходимо его собрать, для этого: ПКМ на проект -> `Advanced Build Oprions` -> `Pack Selected Project` - на этом этапе у нас создастся конфигурация для `.nuget` файла со всеми конфигурациями нашего проекта;

4. После создания конфигурации `.nuget` файла его необходимо создать, для этого прописываем следующую команду в консоли:

```markdown
dotnet add package RUSSIA --version 1.4.8.8
```

5. После создания `.nuget` файла нам остаётся лишь опубликовать его в созданный в п.1 репозиторий на `nuget.org` с ипользованием ключа, который ассоциирован с нашим аккаунтом;

```markdown
dotnet nuget push RUSSIA.1.4.8.8.nupkg --api-key <uour_api_key> --source https://api.nuget.org/v3/index.json
```

6. Для использования пакета в `F#` необходимо загрузить его из `NuGet` репозитория, используя следующую команду:

```markdown
dotnet add package RUSSIA --version 3.2.2
```

## Выводы

Пакетные менеджеры в `Java` и `.NET`, по моему скромному мнению, сильно отличаются.

В `Java` на пакетный менеджер сделан по принципу "а давайте сделаем вот это, и добавим вот это, и пусть ещё сборку делает, а давайте тесты тоже запилим в него" - проще говоря, он берёт на себя слишком много обязанностей, что как мне кажется не есть хорошо.

В `.NET` пакетный менеджер отвечает строго за свои обязанности, а именно: создать, опубликовать, скачать пакет - мне кажется удобным и правильным тот факт, что пакетный менеджер отвечает исплючительно за то, что связано с пакетами, становясь благодаря этому простым и понятным в использовании, а не пытается взять на себя как можно больше обязанностей, тем самым становясь громоздким и сложным в использовании.
